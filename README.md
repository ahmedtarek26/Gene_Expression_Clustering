# Project B: Bayesian Gaussian Mixture Modelling for Tumour Transcriptomes

This repository contains a reproducible template for the **Project B** assignment,
which applies a probabilistic mixture model to cluster gene expression profiles.
The goal is to implement from scratch the expectation–maximisation (EM) algorithm
for a Gaussian mixture model (GMM), choose the number of clusters using
Bayesian model selection (via the Bayesian information criterion, BIC) and
experiment with a robust extension based on the Student‑*t* distribution.

Although the primary motivation is cancer transcriptomics, the code is
dataset‑agnostic and can be used with any real‑valued tabular data. A simple
synthetic dataset generator is provided to facilitate testing without
downloading large biological datasets. When working on real data you should
replace the synthetic generator with a loader for your own `data.csv` and
`labels.csv` files in the `data/` directory.

## Structure

```
project-B-GMM/
  data/                # Place real datasets here (CSV format)
  figs/                # Figures generated by notebooks or scripts
  notebooks/           # Optional Jupyter notebooks for exploratory work
  src/
    preprocess.py      # Data loading, feature selection and scaling
    em_gmm.py          # EM implementation for Gaussian mixtures
    model_select.py    # Model selection utilities (BIC sweep)
    robust_mixture.py  # Student‑t mixture implementation (optional extension)
    metrics.py         # Evaluation metrics (silhouette, ARI, etc.)
  README.md            # This file
```

## Getting started

You can quickly try the implementation on a small synthetic dataset as follows:

```bash
cd project-B-GMM
python -c "from src.em_gmm import GaussianMixtureEM; import numpy as np; X=np.vstack([np.random.randn(100,5)+np.array([0,0,0,0,0]), np.random.randn(100,5)+np.array([5,5,5,5,5])]); model=GaussianMixtureEM(n_components=2); model.fit(X); print('BIC:', model.bic(X)); print('Labels:', model.predict(X)[:10])"
```

Replace the synthetic data with your own dataset by copying `data.csv` (features) and
`labels.csv` (optional labels) into the `data/` directory and adjusting
`preprocess.py` accordingly.

## Dependencies

The code depends only on NumPy and scikit‑learn, both of which are available in
the provided environment. If you wish to use the optional evaluation metrics
implemented in `metrics.py`, you may need to install `scikit‑learn` if it is
not already available.

## Usage

1. **Preprocess the data.** Use `src/preprocess.py` to load your CSV file,
   optionally select highly variable genes, standardise features and perform
   principal component analysis (PCA).

2. **Fit GMMs for different numbers of clusters.** Call
   `src/model_select.py` to run EM for a range of `K` values and compute
   the BIC for each. Choose the model with the lowest BIC.

3. **Interpret results.** Inspect the responsibilities (soft cluster
   assignments) and cluster summaries. Optionally compare to true tumour
   subtypes if labels are available.

4. **Try the robust extension.** The file `src/robust_mixture.py` contains a
   mixture of Student‑*t* distributions with a fixed degrees‑of‑freedom
   parameter. This can handle heavy‑tailed noise and outliers better than the
   Gaussian model. Experiment with different `nu` values and compare the BIC.

Feel free to extend or modify the code to incorporate priors (MAP‑EM) or other
probabilistic models. Pull requests and suggestions are welcome once this
repository is pushed to a version control system.